<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Standoff 2: Global Web Update</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #0b141a; font-family: sans-serif; color: white; }
        
        /* –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ */
        #main-menu { position: fixed; inset: 0; z-index: 1000; background: linear-gradient(to bottom, #162b3c, #0b141a); display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .btn-play { width: 280px; padding: 20px; background: #95a5a6; border: none; color: white; font-size: 24px; font-weight: bold; cursor: pointer; border-radius: 4px; }

        /* –ò–ù–¢–ï–†–§–ï–ô–° –ò–ì–†–´ */
        #hud { display: none; position: fixed; inset: 0; z-index: 100; pointer-events: none; }
        .top-stats { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); padding: 8px 30px; border: 1px solid #444; display: flex; gap: 25px; pointer-events: auto; }
        .money { position: absolute; top: 110px; left: 20px; color: #2ecc71; font-size: 26px; font-weight: bold; }
        
        /* –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø */
        .ctrl { position: absolute; background: rgba(255,255,255,0.1); border: 2px solid #fff; border-radius: 50%; pointer-events: auto; display: flex; align-items: center; justify-content: center; }
        .btn-fire { bottom: 40px; right: 40px; width: 100px; height: 100px; font-size: 30px; }
        .btn-plant { bottom: 150px; right: 50px; width: 80px; height: 80px; background: rgba(230, 126, 34, 0.5); display: none; }

        /* –≠–§–§–ï–ö–¢–´ */
        #flash { position: fixed; inset: 0; background: white; opacity: 0; pointer-events: none; z-index: 5000; }
        #death-screen { display: none; position: fixed; inset: 0; background: rgba(139, 0, 0, 0.9); z-index: 6000; align-items: center; justify-content: center; flex-direction: column; }
    </style>
</head>
<body>

<div id="flash"></div>
<div id="death-screen"><h1>–í–´ –ü–û–ì–ò–ë–õ–ò –ü–†–ò –í–ó–†–´–í–ï</h1><button onclick="location.reload()" style="padding: 15px 40px;">–í –ú–ï–ù–Æ</button></div>

<div id="main-menu">
    <h1 style="margin: 0;">YT:Sashok2014V</h1>
    <p style="color: #888; margin-bottom: 40px;">ID: 19961095 | GOLD IV</p>
    <button class="btn-play" onclick="startGame()">–ò–ì–†–ê–¢–¨</button>
</div>

<div id="hud">
    <div class="top-stats">
        <span style="color: #3498db;">0</span> <span id="timer">02:00</span> <span style="color: #e67e22;">0</span>
    </div>
    <div class="money">$10000</div>
    <div id="plant-btn" class="ctrl btn-plant" onclick="plant()">üí£</div>
    <div class="ctrl btn-fire" onclick="fire()">üî™</div>
</div>

<script>
    let isGameRunning = false;
    let isBombSet = false;
    let bombTimer = 40;
    let bombPosition = null;

    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0xd2b48c); // Sandstone –Ω–µ–±–æ
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ antialias: true });

    function startGame() {
        document.getElementById('main-menu').style.display = 'none';
        document.getElementById('hud').style.display = 'block';
        document.body.appendChild(renderer.domElement);
        isGameRunning = true;
        initMap();
        renderLoop();
    }

    function initMap() {
        // –ü–æ–ª –∏ —Å–≤–µ—Ç
        const floor = new THREE.Mesh(new THREE.PlaneGeometry(100, 100), new THREE.MeshStandardMaterial({color: 0xbc9b6a}));
        floor.rotation.x = -Math.PI/2; scene.add(floor);
        scene.add(new THREE.AmbientLight(0xffffff, 0.7));

        // –¢–û–ß–ö–ê –ê
        const siteA = new THREE.Mesh(new THREE.CircleGeometry(5, 32), new THREE.MeshBasicMaterial({color: 0xffffff, transparent: true, opacity: 0.2}));
        siteA.rotation.x = -Math.PI/2; siteA.position.set(-15, 0.05, -15);
        siteA.name = "SiteA"; scene.add(siteA);

        // –°–ü–ï–¶–ù–ê–ó (–ë–æ—Ç—ã)
        for(let i=0; i<4; i++) {
            const ct = new THREE.Group();
            const body = new THREE.Mesh(new THREE.BoxGeometry(0.6, 1.2, 0.4), new THREE.MeshStandardMaterial({color: 0x1e3799}));
            const cap = new THREE.Mesh(new THREE.BoxGeometry(0.3, 0.1, 0.3), new THREE.MeshStandardMaterial({color: 0x222}));
            body.position.y = 0.6; cap.position.y = 1.3;
            ct.add(body, cap); ct.position.set(Math.random()*10, 0, -15); scene.add(ct);
        }

        // –†–ò–ù–ò–Ø –î–ï–î–û–õ–î–ò–Ø (–î—Ä—É–≥ –≤ –∂–µ–Ω—Å–∫–æ–º —Å–∫–∏–Ω–µ)
        const rinia = new THREE.Group();
        const rBody = new THREE.Mesh(new THREE.BoxGeometry(0.35, 1.2, 0.2), new THREE.MeshStandardMaterial({color: 0xff4757})); // –†–æ–∑–æ–≤—ã–π —Å–∫–∏–Ω
        rBody.position.y = 0.6;
        rinia.add(rBody); rinia.position.set(-2, 0, -5); scene.add(rinia);

        camera.position.set(0, 1.7, 5);
    }

    function plant() {
        isBombSet = true;
        bombPosition = camera.position.clone();
        document.getElementById('plant-btn').style.display = 'none';
        
        const bInt = setInterval(() => {
            bombTimer--;
            document.getElementById('timer').innerText = "00:" + (bombTimer < 10 ? "0" + bombTimer : bombTimer);
            document.getElementById('timer').style.color = "red";
            if(bombTimer <= 0) { clearInterval(bInt); explode(); }
        }, 1000);
    }

    function explode() {
        document.getElementById('flash').style.opacity = "1";
        setTimeout(() => document.getElementById('flash').style.opacity = "0", 150);
        if(camera.position.distanceTo(bombPosition) < 15) {
            document.getElementById('death-screen').style.display = "flex";
        }
    }

    function fire() {
        camera.position.y += 0.05; setTimeout(() => camera.position.y -= 0.05, 50); // –û—Ç–¥–∞—á–∞
    }

    function renderLoop() {
        if(!isGameRunning) return;
        requestAnimationFrame(renderLoop);
        
        // –ü–æ–∏—Å–∫ —Ç–æ—á–∫–∏ –¥–ª—è –ø–ª–µ–Ω—Ç–∞
        const siteA = scene.getObjectByName("SiteA");
        if(siteA && camera.position.distanceTo(siteA.position) < 5 && !isBombSet) {
            document.getElementById('plant-btn').style.display = 'flex';
        } else {
            document.getElementById('plant-btn').style.display = 'none';
        }

        renderer.render(scene, camera);
    }

    window.onresize = () => {
        renderer.setSize(window.innerWidth, window.innerHeight);
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
    };
    renderer.setSize(window.innerWidth, window.innerHeight);
</script>
</body>
</html>
